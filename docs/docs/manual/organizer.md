# 大会運営者用マニュアル
大会の運営責任者はやることがあまりにも多いので, その業務についての説明はここでは省く. ここではCardinal Systemで効率化できる業務とその使い方について説明する.

## Cardinal Systemで出来ること
運営側の業務を効率化するツールとして, Cardinal Systemは大きく以下のサービスを提供する.

* スタートリストの出力[Excel形式]
* 当日エントリーの事前受付の処理(スタートリストの訂正)
* 上陸システムとの連携

## 注意
以下の作業は管理者用のアカウントを作成し, ログインした上で進めてほしい.

- - - 
# スタートリストの作成
CardinalSystemでは実施種目,エントリーデータ,(大会記録)を指定の形式で入力すると, ワンクリックでExcel形式のスタートリストを出力できる. スタートリストを修正したい場合も組とレーン/試技順を修正するだけで, 新たなスタートリストを作ることができる. スタートリストを全て手作業のコピペで行なっていた場合は画期的な効率化になるだろう。

では, スタートリストの作成手順について説明する. 

## [1] 大会の登録
1. Cardinal Sysemにログインし、`運営者ページ`を開く.
1. **大会の管理**をクリック.
1. 画面左上から`Comp`を追加をクリックし必要な情報を入力する.
1. **保存**をクリック

以下は大会`Comp`オブジェクトが持つ情報である.

+ **大会コード[code]**: 
+ **大会名[name]**: 正式競技会名
+ **会場[place]**: 会場名
+ **会場コード[palce_code]**: 日本陸連で割り当てられている会場コード
+ **期日[date]**: 協議会の開催日, 複数日で開催の場合は大会期間の初めの日
+ **主催者[sponsor]**: 大会主催者
+ **運営団体[organizer]**: 大会の主管団体
+ **状態[status]**: `Entry`(エントリー受付中orSL作成中), `StandBy`(スタートリストが完成し協議会の準備が整っている), `OnGoing`(競技会期間中), `Result`(競技会終了, リザルト)から選択.



## [2] 種目の登録
1. Cardinal Sysemにログインし、`運営ページ`を開く.
1. **種目の管理**をクリック.
1. 実施種目にないものがあれば画面左上から`Event`を追加をクリックし必要な情報を入力する.
1. **保存**をクリック

以下は`Event`オブジェクトが持つ情報である.

+ **種目名[name]**: 種目名, (ex. 100m, 走幅跳)
+ **種目名略記[short]**: 種目名の略記 (ex. LJ, HJ)
+ **性別[sex]**: 性別, `M`(男),`W`(女), `U`(Unkown)から選択
+ **順番[order]**: 記録について、数字が小さい方が順位が上(`DESC`, ex.100m)か数字が大きい方が順位が上(`ASC`, LJ)か
+ **プログラム形式[program type]**: プログラムの形式, 8レーンのトラック競技`Track8`, 長距離種目`TrackN`, 走高跳と棒高跳`HJPV`, 走幅跳三段跳`LJTJ`, 投擲種目`Throw`.

+ **風[wind]**: 風力計測が必要か否か
+ **区切り文字[separator_1,2,3]**: 記録の区切り文字,(ex. 001234 ==> 12"34, 001234 ==> 12m34)
+ **プログラムの掲載順序[start_lsit_priority]**: プログラムの掲載優先順序


## [3] 実施種目の登録`未実装`
競技会で行われる種目を登録する. まず以下の列を持ったCSVファイルを作成する.

|#| column |  説明 |
|-|--------|-------|
|1| comp_code | 大会コード |
|2| event | 種目名(ex. 100m, 走幅跳) |
|3| status | エントリー=`エントリー`, スタートリスト確定=`StandBy`, リザルト=`Result` |
|4| section | 対校戦=`VS`, OP=`OP`, 記録会=`TT`, その他=`XX` | 
|5| match_round | 以下を参照 |


### match_roundの選択肢

| match_round |  |
|-------------|--|
| Heats | 予選(トラック) |
|Qualification | 予選(フィールド) |
| Semifinal | 準決勝 |
| Final | 決勝 |

### 例: 実施種目登録用CSV
```python
	comp_code,event,status,section,match_round
	'1234','100m','Entry','VS','Final'
	'1234','走幅跳','Entry','OP','Final'
```

以上のファイルが用意できたら, `運営者ページ`を開き**実施種目の追加**をクリック.画面の指示に従ってファイルをアップロードする. 結果は`運営者ページ`のトップ画面から確認できる.

## [4]エントリー
エントリーの方法は2種類あり、個別にエントリーを登録する方法と、CSV経由で一括エントリーする方法がある.

### 個別エントリー
`運営者ページ`トップから個別エントリー登録を選択肢、画面の指示に従って必要事項を入力し、確定させれば良い.

### 一括エントリー(CSV経由)
実施種目を登録した時と同様にCSVファイルを作成し, アップロードすることで行う.CSVファイルは以下の列(カラム)を持つ必要がある.

|#| column |   |　説明 |
|-|--------|---|------|
|1| section | 部門 | `VS`,`OP`,`XX`(=その他)のいずれか |
|2| sex | 性別 | `M`or`W` |
|3| event | 種目名 | **種目**で登録したもの. |
|4| round | レース区分 | `much_round`と同じものから選択 | 
|5| group | 組 | 空白でも可 |
|6| order_lane | レーン/試技順 | 空白でも可 |
|7| bib | ゼッケ番号 | |
|8| name | 氏名 | 全角で姓と名の間に全角スペース |
|9| kana | フリガナ | 全角でも可, 姓と名の間にスペース |
|10| grade | 学年 | |
|11| club | 所属 | |
|12| jaaf\_branch | 登録陸協 | |
|13| personal_best | 参考記録 | 表記方法については以下を参照 |

#### 記録の表記方法
Cardinal Sysytemでは以下の表記形式をサポートする. DBには半角数字6桁で保存している.

| 正規表現 | 例 | 使用記号 |
|---------|----|---------|
| `r"[0-9]{6}"` | (12秒34 ==>) 001234 | なし |
| `r"[0-9]{1,2}'[0-9]{2}\"[0-9]{2}"` | (1分23秒45 ==>) 1'23"45 | 分=`'`, 秒=`"` |
| `r"[0-9]{1,2}\"[0-9]{2}"` | (12秒34 ==> ) 12"34 | 秒=`"` |
| `r"[0-9]{1,2}m[0-9]{2}"` | 12m34 | `m` |

ファイルを作成したら、`運営者ページ`から一括エントリーを選択し画面の指示に従いファイルをアップロードすればよい.


## [5] 番組編成
読み込んだエントリー情報を元に番組編成を行う. `運営者ページ`トップの実施種目一覧からスタートリストを表示をクリックすると、スタートリストのweb版が表示される. スクロールして下に行くと番組編成のリンクがあるのでクリック. 組とレーンが編集できるので必要なものを入力する.入力したら更新ボタンを押す.

番組編成が確定したら、**番組編成を確定**をクリックし確定させる.

### 注意
* 番組編成がされてない人は組を`-1`, 対校戦の補欠選手の組は`-123`に設定する.
* エントリーを登録した際に組とレーン/試技順を登録してあれば特にやることはない.


## [6] プログラムの出力
`運営者ページ`を下にスクロールすると種目一覧がある. 各行の右端の**Excel版をダウンロード**をクリックするとスタートリストがダウンロードできる. 


また対校だけまたはOPだけのスタートリストをダウンロードしたい場合は, 実施種目の表からもダウンロードができる.

### Tips
対校OP共に番組編成が確定していると, **SL**の列に`Ready`と表示される. 



## 上陸システムとの連携
`運営者ページ`のリンクから必要なCSVファイルをダウンロードすることができる.

